package trust_test

import (
	"envkey/envkey-fetch/trust"
	"testing"

	"github.com/stretchr/testify/assert"
)

var owner = trust.TrustedKeyable{ownerPubkey, "", ""}
var admin = trust.TrustedKeyable{adminPubkey, adminInvitePubkey, "owner-id"}
var dev = trust.TrustedKeyable{devPubkey, devInvitePubkey, "admin-id"}
var invalidAdmin = trust.TrustedKeyable{invalidPubkey, invalidInvitePubkey, "admin-id"}
var trustedKeyables = trust.TrustedKeyablesChain{
	CreatorTrusted:                    trust.TrustedKeyablesMap{"owner-id": owner},
	SignerTrusted:                     trust.TrustedKeyablesMap{"admin-id": admin, "invalid-admin-id": invalidAdmin},
	InheritanceOverridesSignerTrusted: trust.TrustedKeyablesMap{"admin-id": admin, "dev-id": dev},
}
var devInheritanceSigner, _ = trust.NewSigner("dev-id", devPubkey, true)
var adminSigner, _ = trust.NewSigner("admin-id", adminPubkey, false)
var invalidSigner, _ = trust.NewSigner("invalid-admin-id", invalidPubkey, false)

func TestVerifyInviter(t *testing.T) {
	var err error

	err = admin.VerifyInviter(&owner)
	assert.Nil(t, err, "Should not return an error.")

	invalidInviter := trust.TrustedKeyable{devPubkey, "", ""}
	err = admin.VerifyInviter(&invalidInviter)
	assert.NotNil(t, err, "Should return an error.")
}

func TestKeyablesMapSignerTrustedKeyable(t *testing.T) {
	var trusted *trust.TrustedKeyable
	var err error

	trustedKeyablesMap := trust.TrustedKeyablesMap{"admin-id": admin}
	trusted, err = trustedKeyablesMap.SignerTrustedKeyable(adminSigner)

	assert.NotNil(t, trusted, "Should return trusted keyable.")
	assert.Nil(t, err, "Should not return an error.")

	trusted, err = trustedKeyablesMap.SignerTrustedKeyable(devInheritanceSigner)

	assert.Nil(t, trusted, "Should return nil for trusted.")
}

func TestTrustedKeyablesChainSignerTrustedKeyable(t *testing.T) {
	var keyable *trust.TrustedKeyable
	var newlyVerified []*trust.TrustedKeyable
	var err error

	// Shallow trust chain
	keyable, newlyVerified, err = trustedKeyables.SignerTrustedKeyable(adminSigner)
	assert.Nil(t, err, "Should not return an error.")
	assert.Equal(t, keyable, &admin, "Should return the trusted keyable.")
	assert.Equal(t, newlyVerified, []*trust.TrustedKeyable{&admin}, "Should return newly verified keyables.")

	// Deep trust chain
	keyable, newlyVerified, err = trustedKeyables.SignerTrustedKeyable(devInheritanceSigner)
	assert.Nil(t, err, "Should not return an error.")
	assert.Equal(t, keyable, &dev, "Should return the trusted keyable.")
	assert.Equal(t, newlyVerified, []*trust.TrustedKeyable{&dev, &admin}, "Should return newly verified keyables.")

	// Invalid shallow
	missingSigner, _ := trust.NewSigner("missing-id", devPubkey, true)
	_, _, err = trustedKeyables.SignerTrustedKeyable(missingSigner)
	assert.NotNil(t, err, "Should return an error.")

	// Invalid deep
	_, _, err = trustedKeyables.SignerTrustedKeyable(invalidSigner)
	assert.NotNil(t, err, "Should return an error.")
}

var ownerPubkey = "-----BEGIN PGP PUBLIC KEY BLOCK-----\r\nVersion: OpenPGP.js v2.5.4\r\nComment: http://openpgpjs.org\r\n\r\nxsBNBFmCzjMBCAC6y3B/mkv5d5K77MMKxOqbAq88cdCCQk6BQ8KlW1WD07af\n9f2LUnyzPfsguCZTIGaT527eYJYZhbELvAmo3w3L2yMZq/LniBQv41QE2H05\nm2khLeREGcX6dEoPauJz6Fqfg/4VAdovFEbmYCzIfahd/8sxMtaSIX4KMfoN\nyLP8MDM6ujFPGKNLGvArXqsUYb1Hi4nJZOI5vBvLIzMX3jUAJxU+UxO+oKiU\nc994OboSvU6ANdjuGmK5y8MvaHco+SZ+NiijEq8EJDr6hRmivJ+5fvISjKP7\nDpaotN7BWTS02BqmNauSFFFbh0aMSAdU3uIhTP1/9uib1KgKS7j3QGhtABEB\nAAHNjjk5MmY1MThkODlmMDNiNWI1MTYwYjNmNGU4ZjA2ZDEyNDBlYWQ3ZDE5\nNDliNDVmYmMwMjJjNTNhNGE2MDk3ZmYgPDk5MmY1MThkODlmMDNiNWI1MTYw\nYjNmNGU4ZjA2ZDEyNDBlYWQ3ZDE5NDliNDVmYmMwMjJjNTNhNGE2MDk3ZmZA\nZW52a2V5LmNvbT7CwHUEEAEIACkFAlmCzjQGCwkHCAMCCRB+EhPA1+WGuwQV\nCAoCAxYCAQIZAQIbAwIeAQAAw6QH/iUlSG5zmUyUihvh4IVdAqjtGPcLOxxO\nVzhLYQRTuHbgj/8JZ2/XRvFXAf+XH30a/PElDOofaBPEkU5JBKt1t4/D2cn1\no40pSpOpqnatTZba93/awvfU7lKY+KU4XWh47ynefdLjpBkdfLbAhBel8RAF\n9Jcwf2/rSCP9WghFxYnBxcTWTq8X7ic5A90yln0VagbgbLZEFzWkgpLauBaq\n9bYU5KPwSamdQmW0U2KlZQdJB5j3/NGT5SNn/YY3eYjTJtKwgEjyeUGsFhqq\nRrmdgF9k+lOJ32fBwrPMUgaDZfk2c89IoEcW3n8u9Vh2apPUhGbBnj4+KFzD\nYTHJnRBmyRrOwE0EWYLOMwEIANSYbzN7fyExhv2fjrXrY/5UuWFUPpnLB6sJ\npr5Y5v6LrJWAo9mcuFqpfciZTqbhbM2SCE7x+npbMg2qS5ZZRt/7ZQGodaaw\n/CWl51wbAhF3g2qKg/N+OxLfzePxG+gz7U4kUdxdQfvkcXK5RCoOEn0wMRGI\n/JyHQNJT12GCF/XYY8Tj9jWR3nMN23FN0A5T4wYEWei3ReXb9hUFKopc97la\ngkGjSyXbYZOH5XncBQ4dq4KuU661O5QyGGA0Kc8wjC7PTB+5vVonEio15eoM\nB8H94zwf5PAo8tEClKOw/WBtDk8rs60V/i1kDELIMlHjxp5qYFOlxAO4/VVw\nPb5vOfsAEQEAAcLAXwQYAQgAEwUCWYLONQkQfhITwNflhrsCGwwAAPNZB/0Z\noMNT2B1uzAK82EpD6BZjyjeejDEQZu0sDwwihBe0b9KhaJJNOiSVK+CMC6JF\n0OexaQBRdFS0FReofVbM35oOLc+X7XVAzmt9+3AcgsxLcqduVYSz9HfI7MdD\n5FS+QiGhExlLVNY/CAVtE+2/oNunDQszdHK31I7FQU+8QKnMt2UEOtrdfXby\ncBfKb7P/8EU4IlJP98qepXn4m29PgrxXiTwXl5lJYcZ0ilVmJuf9JfcMMggJ\nbS1PtNOd1h1JA8THRcsbMnRJOfOfcujwthGlUrPQGKfOZnnT70hY+/ohGJLT\nD0C+/TSjGDWsEHrK16YpQ5xfOoPZvh3HsYzpAqjR\r\n=XXQ6\r\n-----END PGP PUBLIC KEY BLOCK-----\r\n\r\n"

var adminInvitePubkey = "-----BEGIN PGP PUBLIC KEY BLOCK-----\r\nVersion: OpenPGP.js v2.5.4\r\nComment: http://openpgpjs.org\r\n\r\nxsBNBFmC0DABCADPY1LFsN5ismxcMoakQHsI99vqVPuL4gl8XQjwKuhauDyv\ncfv/TidY4ByvT345kGuKEr1aO7hhQq7zMR4UEr7LFDvxKS/tUP3iDKctojV+\nVEP6pJXNEz6sjRDsBORBgcbQtO6+WVA5WJdajnRO9gvJekYW2oDenZec/Qti\nsYbY42L3X6sHISFeVaE2XxMgOw7kjMDeeTnkjIoMK7jwl6JWJluLzijaZcj1\niB65npGPqPcF1T/lrLlvoZhynaz15GURgs2FfPG30Fh1pnJR/WQyLrQhRCMi\nt6oHsBKS+ALkCqXex5hybwI3hFkVSF/PJNWp7ZbI7/uRiyiekOPP8HuZABEB\nAAHNjmNjZDU3NjUyNTM5MWM3ZjZkMWNjNzlhOTYxZjc3NWU3NmJjNWM2NTNi\nNTk0NDIzNzdiMmNhYWZiZDEyNzg0OGEgPGNjZDU3NjUyNTM5MWM3ZjZkMWNj\nNzlhOTYxZjc3NWU3NmJjNWM2NTNiNTk0NDIzNzdiMmNhYWZiZDEyNzg0OGFA\nZW52a2V5LmNvbT7CwHUEEAEIACkFAlmC0DEGCwkHCAMCCRBxjuox5N0ODwQV\nCAoCAxYCAQIZAQIbAwIeAQAATCcH/jcDS+WYGa21UP01D13FR2ZDW63cxT3F\nH7EIjHQvig3VcVBIFQF/kGkJ4B36dfgOCFxplumy56hkUQ7OQ6Ev5wQwsF0J\nI4UydleTr/KqK9rY2UPh4V29HxrmBe0iVu2CPLYHzLqfHGDLK5LNlRgpPgQZ\nkdNJJOPQIUn4HQ10O8fZf9MoNjv8NSs+kFtQXQp/cwuh+hPXaqG9j5f/EYwp\ngMem0KDdMcHZ8/x2++LCgjsy07fGczXX6W94Uy8Yr9tRBqXC3oj/Q0eNA+lf\nwvW8ZSf2r+2dATYgelyCoY18yYwITTn2sbxNkVsNT2df1KnA6WcIWTVErlJ8\nyiq0+p1foBrCwF8EEAEIABMFAlmC0DIJEH4SE8DX5Ya7AhsDAADvGwf6AuhP\ntGq2sUbIZx4GdpZ6qu8OgcmSLhpgaDpuCiassm9zCjm/FkxwliywMlGCCMGR\naQVnVJPgGSFvrLpAoCL6qSOb5JbxXi4JQYZM2qlBzwcwpnF1R1Pcm5VNL1gu\n6kLy5+Xc0iM+JMsSlDU8SFunypASVzlgviPYLzpGLsXJREFGq4MCTnzk1iaQ\ncOMsHSQP72/re8K1XX3Prhz1uxBLrbmNB98jlZzW5D43b+J87gmsI8TXF65r\nRxtssyp81G26z1px/yCtyQN6Qe/kxlbO6drnRlk+u20LkhI1m0P15Z8CrwLM\nVNEcSRGxEsZVxJWfY13OjNiWuDNIKjqOI3us6M7ATQRZgtAwAQgArPUe9IPT\ncpMBb+k0SavL9h0Gux3waAwjgvMWjO0mJ/BT6z6At51OVQVf492MLuZ+UmDA\nLZSDksRryvRETn/dQ7apOtwpsYfb0XZQjhX5svP0VhtqrWqoTMkClhVeQ4Oe\nhEM/g1ph6OB4OqAOXZ7RBoAv37X4ekUF/Onp61wZqudxRlVb0v/gZDtl1KHt\nuDuhipvMfUNaV4CIOzbmPIdrjTYneY9KEp/zHPAj9DEjOOu6MjImuhdFTEXE\nCn2uXY5tLLBhcMb/CcURfF8qI4i5oebfTBSVYjipQtVONCNsWvG54PVpzv3S\nLngmoHQ9807lnLmFeC8Eah4zovFDGOteyQARAQABwsBfBBgBCAATBQJZgtAx\nCRBxjuox5N0ODwIbDAAA0JoH/2hCMx4Biod77+UMUBIA526XLTwrVYSfO2kU\n89a5ClJh3ynKdZShA1cD9IZm+tcegBITs2puOw2MPwWw16AZCu1OP3y4lScI\nhWiMF1WfQ24PB+nhto5Z/ITTxX1OtJcglow1lnFa6uWu53XCbwuGAR7+FhdC\nA9vYBLgAotI6/feOK8btx5MjaYxogh5x0Mk/CwhVbIZ7ao0lFneqdfmoa11F\nRhGKsEVl5hcckgqM/6nIcNO5r/W3HZt+T3jUVTIlNA6+DikGQiHCHfXmlAd8\nPxS8HlLF6UkWpRcT8DBvMtDEbKjwnxD+UxwIDxW0/rzeaVlx50jL6ePrXJ8v\nsajdogs=\r\n=GNbh\r\n-----END PGP PUBLIC KEY BLOCK-----\r\n\r\n"

var adminPubkey = "-----BEGIN PGP PUBLIC KEY BLOCK-----\r\nVersion: OpenPGP.js v2.5.4\r\nComment: http://openpgpjs.org\r\n\r\nxsBNBFmC0F4BCACs8kvQHbmyDau+90KdYV6uyubj8m45mqoxsw1mCB6HP3G1\noCgFc+UX76ZWkgyhCV6lS64RMzypaX+W5sxNfeJhV62oCJHxOMQv3HI+9kZJ\nJ/aREAkDx83wooVDj5sJ/1U6eYGl1X6yfoideNwljhp7Wd3gmTY1NetE3EiK\nDth74nWC7H/JjIfyr8GwN3EHhV4brBHQ51MSK9+WlOmV8xk2WgpAPLIOcwXg\nKNwP9wRZebhD0/SO/szGs5pIGkN85jzXnAQVRa7XJKsGAoZrWkg1N54TO4g9\nLSOdTZdpFNFxsICL+ECsUzFkRrjUvDEHEYHB5QM+FloyjTsLb+lf6yOfABEB\nAAHNjjY5MTg3MDc2NWJmYzU0ZTgzODkzMzdkOWI1Mjg2MDhlMTEwNWI1MGEx\nNzcwNWVlZjk2YWIyNjc0NzNlN2UxMWYgPDY5MTg3MDc2NWJmYzU0ZTgzODkz\nMzdkOWI1Mjg2MDhlMTEwNWI1MGExNzcwNWVlZjk2YWIyNjc0NzNlN2UxMWZA\nZW52a2V5LmNvbT7CwHUEEAEIACkFAlmC0F8GCwkHCAMCCRAhqabOVb5DegQV\nCAoCAxYCAQIZAQIbAwIeAQAAzd0IAJaYW+8I0czFO0PQVJfAP2cveCyOVmj4\nrqCc0cXhU+qu61uTiFEzOO5oXFFjHFj3yEIDnkmlBxj0EXgOCX1NtB05GZpy\nfx2GEbTX4b0t6FVenAQQpY+O9adqQHc7toFe6zq+ZaVrIrH4CAMG0OLqXBYW\nlGRKREEd5Xnaw/OO5d+06haltNdThDuQPqxgMsFEofSA20bntVaNqBgmP9qT\ns3lc5d5XEZS9BFf22nLNHL7Q5tXriMdojnSafEYuGIUVjvCU+O/N7kqr5fvq\ns4LefIeKpBIo4SkdeszFtfxtsvwxfbsmdLs0ByLEZDUl9HYM29JwYsGbitIJ\ntFAocr6EXTfCwF8EEAEIABMFAlmC0GAJEHGO6jHk3Q4PAhsDAAD0sAf9GNFH\n6xolXRniEDuPvqy/YslxiKXe28M4hNzm4KyFCcR337G75+WteyBKWMT1TOci\nV9BgFXGIgOUpVKa+2DTxgswecYlRYpNnlsdW7k7Pr9OO5//q2mCHQDT/Od6g\njZa3RdYp9za4ZZvNFzTpGZ2pKrLsG04l3asvEZmYTAlb43SzvoMtuYJHBiLV\n0hrS8hm2AKI1YAbgxZRT2BsqJgzL+h/hCWM0jqy4QWqz4k+61gvm919Rn0a9\n/vfluID/BdIpI6047qTkjIM/WfiEOntioHt/NhGf+pIwqEymkJvbbj/41NYT\n6lobQlI1ZbylYQ77gkDDXa58WUZFqiyVWWejEs7ATQRZgtBeAQgAz0aBb+V6\n6jJeCb+W+4aWw/icpqI8OyV7vtwAPTZdmCdj7Gnx6EOrBvda85uQBNgqE27j\nWPwL5mYnYQKnZhlf+7dHOT4e/UoxYsimsuC2XhuYFF5fYfpoY+YXVZL5DIbJ\nA8AvZMg/yZ3go+bn2oK3OuGNWiBoVBmcN8vyd+O/0I0gEVUXJg511+0gGFM0\nTZAKx09sWzptQjB9/DLjnEekqU7r/UeSuFG1Nnx+FF1K3M5lNS0TXC+7tty0\n3zDI9vLDDRB++6NUuI2C9F85ytvmt0Q6/adHImbOLvOOeTXzxuP7U1VPGrml\nUaUG7xkvkz05PUPrYgeLbTU+/MKE8LiNswARAQABwsBfBBgBCAATBQJZgtBg\nCRAhqabOVb5DegIbDAAAN+oH/2Kkl1ILyjB+7mOjS8E8y+IS+DzvO3TfpRSp\n7SkpC4PzTP+xQRt+SMd+YC2cnmV2id7hS2hIMxlhOPbLFfV6h/wlLU7pbJe7\nYoDM3aStMASKrktWhs1fkJn4qbQnPcVImzPmy/sTkZ3vXtJaSKETNupP33e/\nbZ2ti1J6XWzXHwjXLTBIR5wkUfplgogpjb6ENwW/B5qvRUvcatESQBYZO9yH\nbV0juAdtziOw5zvhyKLo53bZbR3dSljhwiMXbAy36+9CFKwfgelyCY1ULPvD\nVdr+X84e0AVhx1mixmAJ8b3HtejU8EEu44Rcw/wxw7Mm96WoiAfn+fwxwtkh\nwBPREsc=\r\n=Hqj8\r\n-----END PGP PUBLIC KEY BLOCK-----\r\n\r\n"

var devInvitePubkey = "-----BEGIN PGP PUBLIC KEY BLOCK-----\r\nVersion: OpenPGP.js v2.5.4\r\nComment: http://openpgpjs.org\r\n\r\nxsBNBFmC0ygBCACjvi/8bubhPeFMWgEKoq9MHeJh24uiQlW7IZLBWptitdlD\nDLIK60UtBE8t4JHerjjlUQnxqW88Z9zUuct4yAXvgOSuGISwGRWI922CK8H6\nmnLnm2lPwaL7JAEqrZyWuVdipDw7FK4cflNG/60Gqdv+jXZ2NWKGnt3bu21x\nIK/IoO4VQ3GrCxraWWj3IUHVRyT9QbZDXM7vLSigi6liFnNjidcCd2G2JlqN\nR80uMh6g8W9G6jpjJmAPPgxgRMR7AHu+jsp1mDgTKaMa1CQ6Nl9JNIULho82\nFXpXjI5dsV1OzPI4QvrLbLF2rSQXrdy3YkejqsyY2kOTkwjMGjDNttWrABEB\nAAHNjjJmNmJlODcwY2UzZDExOWU5Y2E2M2Y4YTMyZTE0OTQwNTY1NDIxZWU3\nNzVhNmU1ZTJjOWRiZDdhM2I3ZTdjNTcgPDJmNmJlODcwY2UzZDExOWU5Y2E2\nM2Y4YTMyZTE0OTQwNTY1NDIxZWU3NzVhNmU1ZTJjOWRiZDdhM2I3ZTdjNTdA\nZW52a2V5LmNvbT7CwHUEEAEIACkFAlmC0ykGCwkHCAMCCRD+7q2LjtEtgAQV\nCAoCAxYCAQIZAQIbAwIeAQAAp/MH/2hhMOxTNymMkr07PvF/7qyX+4FtUjUq\ntwVfYnmjLxffuG6iQHgaR7yFfkN/OoNZh48bQbfI5mCUm0eQDFu/uT0/bANT\nXITDt5dqJPSNXu7Et+CWa9+6R9c99DB97O5RSQt/obzLJ8Ekuo66gJ1dviAM\nuXn+1NBFGNO5TpT4e74rxG0BbU+/APqHKPCfbdSNj8c9qtBpmElO/7H8uu9t\nKdqOBpi6VaIrH/0wzms0I6nf92vPYAGVqLx4lwV4lQdrvghKBbjXTkKvNjJL\n2m8D4BGtmZNM1tMzoWl71MyPOd2W/UI8CJcjgh5zZQdL5isa1zwVtsygsf8R\nnMKfTXqKKuvCwF8EEAEIABMFAlmC0ykJECGpps5VvkN6AhsDAABKXQf+J7wL\n9kOmIYt5LbYwj05IOUWyHnCvzEpyi7vmr0O2/D9Vd8PyuNcuniaFNfQFZEqN\n2gS3UDlDdWxnzDQTY1SUDSuv++23I3HTUl51pIvi2ui3UHCgGrEoBhzlKNPC\n77z1g6VG0EdMZXoZrda7glArZnpB+OYhgBBCtGHerABr6kA6AL30b+5xQqxM\ngHf1r1Bo6Wa0HH7Co+01ziXGzZP00Kd5laLdkZY263NZbFx/wlxbc7Jd0voU\nTxc9/kNq8x77Xc9Kz53nwjlmqrMlS7IXOCEy2dnm/Cd/kGuhZOnVWSkCrVxd\nIZ6CDWSG+af4kWyBrAt/L1y2ONbSIxccJMd/cM7ATQRZgtMoAQgAv/ecx7xF\nk6XWECgiYDkCUnzEd4nI67ozXH3yAKbx9Epi2EusS2/GbvLzfT6UZF1XlCUu\nlOgz6WXr+fcUoRG2iTJ1J0WnRFzqK5mW4WH3LaQWNYnvFB2y0dGF6I7NMeJ5\n+ll8j1OtPqee9OUj/aFD3DUiyGEjNBnfXSqjlh6N1od2lW+vJku9VR++yy2H\nJ57yx+ZcXLWkVPdAMKInsM7z1ieldl4lS7skKdXClMUmhbunQGjMHzO2J5Y/\nLNVFu/AzbmoF13sFSmDWQ4JA+1r4uK5z2asPi/N5uWQ6vbhOtLbAaY85f+Qr\nshv7qqq6cCxJ3Ey43LtTrtoYoYak/e/7zwARAQABwsBfBBgBCAATBQJZgtMp\nCRD+7q2LjtEtgAIbDAAAxeIH+wYDN2PgKikck2d/asO5O7Hdf2D5nBQghRbQ\nQCd9dJGOhAwrc63kuwUbU/gf801dyqKwLTWlExe3TWMvAvMozfAmIINVRmcB\nqsV0XrE/m8EQZEWVmU9JdXMJLwcwdc8htPrNJhV2yzq2Pqtjpjz4KMCBh4Pj\nCu/rp8qFWIqX2sFezJGm/UEAFS7hhGZMyR4Lqsu8VXx4L0s5mH0wWbEoV1Rs\nz+oydTxqTre/URTR7KL57FcwUBT9nfIv9V9z4EEPu1PSiv54+YSMLMOrzFtF\nQCFPhxivAN7FPTDGQbT3ml0/I8jZekYd0zaSz5iVMQQPA/iWQnH4XFbZtmY7\nq2J8bDY=\r\n=jyV+\r\n-----END PGP PUBLIC KEY BLOCK-----\r\n\r\n"

var devPubkey = "-----BEGIN PGP PUBLIC KEY BLOCK-----\r\nVersion: OpenPGP.js v2.5.4\r\nComment: http://openpgpjs.org\r\n\r\nxsBNBFmC01gBCADM8QhusotNSsaHmMEjgsxy/X2wtmR26Fmqwu6U0arLinrL\ni6rTGoVNsjpVOiPNnVHdJdNhhUtw425XMio1RyiXDiMRCJmyHdZNaRmXWECe\naaiJaVbShVsUl5Y88y+emR9Jmi+TvNdVOtW72eu4x6TdjG+juvChwTqVyP9u\n8uDUBNlclQv9VLGaVHefmOz3AysrCGEHGrKio8wuU1K1d++UZP8vuFOcI+be\nAyLftXDKVXvz2fzzUXfHkO9xdjJ9GMoSUy3dmGacqHSocrdmmitvkLQiAsAJ\n5R4qY/hAPEuXGyOk+HlsDAQUM9HW+BLA+zIhEIRBaupvOUVWswys++yvABEB\nAAHNjmJjNzEwNTcwNjQzYWFlMmE4ZjRjNDBjY2FlZmRiZDI2MmViMGQ2N2U2\nMTcwODJjNDFiMGViZWZiODkxYWEzNDQgPGJjNzEwNTcwNjQzYWFlMmE4ZjRj\nNDBjY2FlZmRiZDI2MmViMGQ2N2U2MTcwODJjNDFiMGViZWZiODkxYWEzNDRA\nZW52a2V5LmNvbT7CwHUEEAEIACkFAlmC01gGCwkHCAMCCRCGj6nvX59MHgQV\nCAoCAxYCAQIZAQIbAwIeAQAAVcUIAKPm/t5H3MDw22majFygSeBy/469CAt1\nazqvo+GZxgw82854AmUQ/OUDV0h0auHXYYzFfT6wKcusN5nLptYQhyftsxIJ\ngCB1Ikw0a73aEeNmQ7hVpkfKksg3Q9Tc1J+syCtIpP5wCFtpskZ/dzRc2ek8\nS3wuRPLOAebrTAOMmtLt0ukG2y0kQxNJhl55aKi7BaKySYgi88sGssA6Xl1H\nIppzSwQvd7u4gnFKs816MOf+uV3i4+4a6gVHZFQRObZ+S7tpX/GabjQd+JBk\ngYxd6y3FiHNHnDnfMTZcBamoi0XjRKFHUduUVzytfMlPLLzxGSanrcWYiPiS\nxHc3Q9WwsffCwF8EEAEIABMFAlmC01kJEP7urYuO0S2AAhsDAACc3QgAmvd1\nykxiVDkqbAIU/AyjMG1UPSSpzpIas/owHhvk6EDZR2sJ7U9zMG+rXYUwpFIG\nWfqqdPstXQhM2M0DIilqMZ5qvH1ceoPZLbyHGBsA8Y2z87qQl55IbivIsvIb\nNO6cYeGnz3CFbRNJytoxcjdBFVo+o91Sm/RCFyX5RCVhxP0ZkTWULEqkKcPk\nLOJLLTbRTO3vxNj1IgBWhPVktE8s35byiG7w3/2wOO6cDgKg7q5RaiP6h3vG\nq4WzrzjaVQPNoLwaR62B/csPSdYMoFBLaLtjxj9xqYJUDUO7YllhcmwJ6Vcb\nxzgywNvXmkdDJ3tyPkwAQ4xkeFI2bFdm8a23gs7ATQRZgtNYAQgAsMWohCA7\nY9KxANp0RGmDLQmreIyEG4daAZd2VE2+itJqK03g75U5/WFvnbtrxCL8+yUd\ntjivrHRK2uAGfBtfBMdPeFG5g7+6QvTOYHCvm33lrue5rM/yS2atrxhLcn81\nNddRwDRMpAkb1rXBiAtXd9IXgAJ8EJln2hQ7g59OdGubEfbFlCbESkrKV8f0\nmm8s+B8gqA6SLBe8jkE5tBkOPVPMmEu9H3UR3W3F3lPhjXy7+N6GtTUR50Yp\nBpqhh2KlU+p2DCxddAdGvHGTzQ5i4045otNSMpIFEAnga5LAFrJnLXKBChi2\n6zcn3n8YC+cIXf2PDKQVS9NN8SzbQcTQ7wARAQABwsBfBBgBCAATBQJZgtNZ\nCRCGj6nvX59MHgIbDAAAm4gIALh/a7W6qZwqxMkqavcphN/Ed36LeTuSDrOl\nhARFjmUub4ziznCGI+P66wL0I/eMaWr2lZvJC55S1SgrUHzVjF+4gZzrTVVw\nHrU8DPJCJFb8MT0gpXe8iKtWboXlaX0V6xX+uT0xy387cSUvygRKtNKFCIlH\nRz2QMrP2CWFjYLvNSsvVxZp8mfY/3SydhCjmnGG8xu/oYuEMjypOZS5kdCYU\n5J0+fOCMKIBk/25U4+1dFNeQtvKeEYjFe0zlAfk0IA0JL3S1oVAPqF4vCSxQ\nwklE3L+j6NyYi6sNfMsT0Oo9NAi8z4IFPBCXJauUbKiCyzih3FZyX2rKUd6E\nX4FjiY4=\r\n=gLAh\r\n-----END PGP PUBLIC KEY BLOCK-----\r\n\r\n"

var invalidPubkey = "-----BEGIN PGP PUBLIC KEY BLOCK-----\r\nVersion: OpenPGP.js v2.5.4\r\nComment: http://openpgpjs.org\r\n\r\nxsBNBFmBC4IBCACl7nerYYcOByK8ytPwN1MUohF94c9Xkl9sF4upzKmioiA8\niNwYwcE7fzd3r5lsJg/Kfijf7kfa083okzHufHSwPWt6WSe7svPmVpq0g+qr\na8vHNFteDv9h1V1EAzCe9iB0BpsVwJ4eHv27cCzpkdu4G5jpoG+7LVS9DSe7\n332JwuzMGQBZ8yg7UxkhTHbIfVFBEh+Ae1OINiVaMGC52BBAS+1bIC0VRx+w\n9F+QX5mRaF4QVzffrGOlU6T04QmLCTTJvRA6kM1zxPNYNZB0XKRD/MiRg31A\nD5jqY3adLW6xPoe5Q6YSXpJfXTh8Nahsy3lzkc2gssUuGgOACr5HIupzABEB\nAAHNjjVhNWI0ZTdjYmJjMzJjZjdiZmM0NmQyZDFiYjZlY2ZkOTI1Y2E5NWE2\nZDdiNGQ3NDg0MDBkMWZhZGQ1M2ZkMTMgPDVhNWI0ZTdjYmJjMzJjZjdiZmM0\nNmQyZDFiYjZlY2ZkOTI1Y2E5NWE2ZDdiNGQ3NDg0MDBkMWZhZGQ1M2ZkMTNA\nZW52a2V5LmNvbT7CwHUEEAEIACkFAlmBC4MGCwkHCAMCCRBN+98ZEYM2tAQV\nCAoCAxYCAQIZAQIbAwIeAQAAXWgIAIfU71QBr1YPC3EYQJrK6Ulq4tm5F2lC\nz47fpcWW9gFgHP5bEcHZtqHRChiYb/zznAAj4aYT6tx/zxEjYskgp67oS6lB\nRSEgfzVU230y1fFGRjEkgEP4aC8vtgCQaR11xQJ5cFeucQ9B4h/GWFnl4A3p\nfi2Sn5jWdtfjzQOR5FdbOBlnjA7AIeh1Mnr5Grlj4blVZsHkdRWGgrmRvmFY\nz4va5ACyg0F02AA8ilTrSOoiA/Q7bBmcuNoFpoTWIkjVoh0u9mQddyjsqZcz\n5TyUHff5iyh0jA+cdQNZZbqUy6GY76tY0ftBqgdMnYhl5q1D1yLHePIkZQcT\ncCVc9rVWFH/OwE0EWYELggEIAMD/AsPtS/NkPH8g6Iq2YZGleXkCPDzm72O7\nfK41v3qWxHWEaJHqPUWSVusRr15kBef5CHyR5vbQ/DlrurC2XkDxZXTJwCwd\nAJS4plrKgqSxvAg1uBFA8WJ6ol64A8e6tfidJ3BKXJpuTFEvJfMgZJhGXApf\npvwjr14q1JgssiVZB05N76E5EQ6A0qYequYLOElv1+OqLF72+5JtvfmxOE7D\nFlSyXFtha0L/mHx+YF+pjdKxAMSGCU8Mgtdy8VhhrE8jpdAMwVvrEaM9/sDp\nnT8DNq7k7MyLAx9o5Scud6nnj/ApfEZQ+qplUDpCc+q/jFUFr/9Mcwpw3j1G\neTYSl+EAEQEAAcLAXwQYAQgAEwUCWYELgwkQTfvfGRGDNrQCGwwAAIj4B/4i\nLzAVDDpEgzMjJWOtJt56aVcCddrrNBpokXkNt6Csi0xMSULDFJ+GwuWe4FC6\nz2OqfdCZSKSK0urn2CjVtjmKMOti6n2zHsyIjPa6fANiN5AT2jN24/tFBYGq\n0TepPaq9TqJ4p6Pl4X+QZx0XU4dTuCzjVmPBgt5CEm6Xe/ZL8OUCOm7LXN5V\nV6ZvGA4czqYv88I+a/d7a0kSwxAfXFHdDywSoUiTds4guNtLoYvX8ey8DRtZ\nMC8WtqlfTWFL+UNKelTs2/AuN2Ee9obNylF46gXu3oWFzfEYyeGs9I0i6ZEa\n7lNJAh0DYRAjzphImhDUFXocx/d3velZ/oCvGAhM\r\n=w9ow\r\n-----END PGP PUBLIC KEY BLOCK-----\r\n\r\n"

var invalidInvitePubkey = "-----BEGIN PGP PUBLIC KEY BLOCK-----\r\nVersion: OpenPGP.js v2.5.4\r\nComment: http://openpgpjs.org\r\n\r\nxsBNBFmBEtUBCACgY9ybvYbW6fNhGCmUmoWaDZTn7CFYC8YRuKBfvmPTms1/\nP80VtY+hl9DYDMJu7V7iP8AwDWVNioqS3fW34RfFkF5/bVZfUEYUOoor0JHc\nHkIJgkayFNSpgiDucWIZ8TLcI/smUjpcT3epvR+tmBil7E0bY80EDEsYz3cd\nIdZGVV2yihwTSRqhPFVYD0iCWwqOAwuecFnpi6roUDXPHUUAuSbazwFsLTyg\nppunqya7le6DaeHX1bG8YPWNk21uK9oehZQbKAE1I7oBOG20vyFCZvStZAIe\nasGGnhE58u94fIv9aopiAz0ngCOyZ41YTp9KY+ZDOdvGkXPIvybIrqCXABEB\nAAHNjjAwNDljMDM3MzViNTEyMzRkNzg5YTA5ZDI1MGFiZWJjODVmMTk5YTNi\nOTBiNDc1NjZlZjY4YjI4ZDk0NDVhYzEgPDAwNDljMDM3MzViNTEyMzRkNzg5\nYTA5ZDI1MGFiZWJjODVmMTk5YTNiOTBiNDc1NjZlZjY4YjI4ZDk0NDVhYzFA\nZW52a2V5LmNvbT7CwHUEEAEIACkFAlmBEtYGCwkHCAMCCRAK77Qge/sL8gQV\nCAoCAxYCAQIZAQIbAwIeAQAA+UUIAIiPMR6ePRiytkJZ1arnmFHuunBgVr+I\n+g02OS6NK8VH2p3ekzud3rrTuMDqvwr9UjD7bb2tnnr9QKoATdsCcQNag3hE\ndCyreYH4r0xYSq5GorhgnGUosaStscHxBOZD76v9Ah5WHpqNh28vdvVUEAdD\nTYHqyALPYYgDJuvv5qrgreEnJavHZohwGOX9PQwdRR5bLbxLciXyf/F4O6Bb\nCEJaWqd4+WrLMKry8C4JafdLYUFlwkfP15SCemuJYCFORbb9qoXNBxWpH50S\nWaB0P4XDdHk36JHmeuOt/FSont7yL5GvXZjJBl5HNWh1TPV2mn5AlKJvh4B1\nTixr7OdDlbHCwF8EEAEIABMFAlmBEtcJEE373xkRgza0AhsDAAAWmggAlDN9\nOXvTz5bcAYoblPLJ97vP9Y4/ieGXH1AYfWQZO9GDIit/n1IgCJEsYxswnO5a\nb2MWEP2pzlQyNHlShN0x/JT7kND4ftLGImxfegmYgRBs50g2DKAu6/vs3Uzv\nqLQ2YoiXylI79pf20Dm/gemoPWTwDPlEgnBzniLfJXat6dM/Hp7VsnsZnWc5\nw3VEmvDPqiwFDDQyCqKYukPGA1lItRaWnwigLHdf6P3IwXKdPYGG1spvG2im\n6BueKkPuys73ItJ2eaJlyTw2YFK1CE6QnJnDv5ZFjAF/PSMFg1XyvAz1tHFz\nvlBdc51H4CUtcXucZvjR1QgbXvP6vT9Xy4iDas7ATQRZgRLVAQgAx5/blkUU\n5bNlFWJ/VtfZioAqpQv+U9RJI0gcChlom5KNVC/XNOApfJilR9PUxs2NZHXm\naQ8QnP2hYYAmAkC8Vq+FLZuPEzYnQPTDIRRoiyIHwRFlIAef8D+ynwyg1CGD\numG3g1WismK5cMoHdbFkvZxhTRYUrJ6s1lXe7Ycb9emD7l++HS5CaIzqnp2H\nfsdlcygJc0lFhJrr1fogpAxaUMFM3uuB5Pg03/az3BqEh7Nhsd9/BwINHHYJ\nnKTr1COw+XzhwzoRzaWt+MvAqoZ+90S41GmqGfV6s3g6f+Ou9PChjgC1ipGt\npirGNxjPnWlmoytQik6BJbWiHCBYRYWtFQARAQABwsBfBBgBCAATBQJZgRLW\nCRAK77Qge/sL8gIbDAAAfBwH/17bcGnFDcGb409wekzja51CRW/E3s+80l/4\nBLrC+qXp/eO/cdN1ymgzqsswBIE2Ror51rhmeTGw67lG6KJYGuoY524Iycwx\nB0G80phGqgrTkvhIyH5QH9wmm8I53slu1HTZRd5AdF6/WUxbafHY5NJlpYEb\nv9AhnGZ2GSBJQ9Q9hQb0EHzG/52pMO/1rpIraG07xlOXwM64u5nwhxLEmQj9\nz9E9xmfl9wZxqzEExtWcinblj7ZCtcdgOfLqHMH0ZGSBGg0bMr5tOjJ8rT3Z\nXtsv+1BXdAHMylzomWlU6fcog2t4uRKTTq5CTBzt5spsgncTR6awXuQ1Fro1\nmzY7//s=\r\n=mmUg\r\n-----END PGP PUBLIC KEY BLOCK-----\r\n\r\n"
